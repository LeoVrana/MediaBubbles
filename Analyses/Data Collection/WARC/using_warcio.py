from warcio.archiveiterator import ArchiveIterator
import pickle


warc_paths = ["CC-NEWS-20171023181729-00079.warc.gz", "CC-NEWS-20171023233450-00080.warc.gz", "CC-NEWS-20171024113030-00082.warc.gz", "CC-NEWS-20171024151542-00083.warc.gz", "CC-NEWS-20171024185202-00084.warc.gz", "CC-NEWS-20171024231408-00085.warc.gz", "CC-NEWS-20171025045504-00086.warc.gz", "CC-NEWS-20171025095909-00087.warc.gz", "CC-NEWS-20171025140034-00088.warc.gz", "CC-NEWS-20171025175646-00089.warc.gz", "CC-NEWS-20171025222104-00090.warc.gz", "CC-NEWS-20171026043912-00091.warc.gz", "CC-NEWS-20171026095847-00092.warc.gz", "CC-NEWS-20171026141110-00093.warc.gz", "CC-NEWS-20171026180609-00094.warc.gz", "CC-NEWS-20171026230105-00095.warc.gz", "CC-NEWS-20171027062054-00096.warc.gz", "CC-NEWS-20171027115652-00097.warc.gz", "CC-NEWS-20171027160119-00098.warc.gz", "CC-NEWS-20171027205400-00099.warc.gz", "CC-NEWS-20171028044442-00100.warc.gz", "CC-NEWS-20171028132450-00101.warc.gz", "CC-NEWS-20171028213746-00102.warc.gz", "CC-NEWS-20171029095511-00103.warc.gz", "CC-NEWS-20171029184313-00104.warc.gz", "CC-NEWS-20171030045608-00105.warc.gz", "CC-NEWS-20171030115409-00106.warc.gz", "CC-NEWS-20171030162815-00107.warc.gz", "CC-NEWS-20171030212033-00108.warc.gz", "CC-NEWS-20171031042911-00109.warc.gz", "CC-NEWS-20171031100642-00110.warc.gz", "CC-NEWS-20171031140815-00111.warc.gz", "CC-NEWS-20171031175259-00112.warc.gz", "CC-NEWS-20171031220454-00113.warc.gz", "CC-NEWS-20171101035514-00114.warc.gz", "CC-NEWS-20171101095034-00115.warc.gz", "CC-NEWS-20171101144143-00116.warc.gz", "CC-NEWS-20171101190739-00117.warc.gz", "CC-NEWS-20171102000913-00118.warc.gz", "CC-NEWS-20171102081318-00119.warc.gz", "CC-NEWS-20171102125130-00120.warc.gz", "CC-NEWS-20171102165353-00121.warc.gz", "CC-NEWS-20171102212237-00122.warc.gz", "CC-NEWS-20171103035542-00123.warc.gz", "CC-NEWS-20171103101544-00124.warc.gz", "CC-NEWS-20171103145540-00125.warc.gz", "CC-NEWS-20171103191737-00126.warc.gz", "CC-NEWS-20171104010240-00127.warc.gz", "CC-NEWS-20171104105145-00128.warc.gz", "CC-NEWS-20171104184201-00129.warc.gz", "CC-NEWS-20171105051536-00130.warc.gz", "CC-NEWS-20171105145658-00131.warc.gz", "CC-NEWS-20171105230320-00132.warc.gz", "CC-NEWS-20171106084004-00133.warc.gz", "CC-NEWS-20171106141038-00134.warc.gz", "CC-NEWS-20171106183427-00135.warc.gz", "CC-NEWS-20171107000833-00136.warc.gz", "CC-NEWS-20171107081554-00137.warc.gz", "CC-NEWS-20171107132105-00138.warc.gz", "CC-NEWS-20171107173533-00139.warc.gz", "CC-NEWS-20171107221828-00140.warc.gz", "CC-NEWS-20171108045125-00141.warc.gz", "CC-NEWS-20171108104148-00142.warc.gz", "CC-NEWS-20171108151955-00143.warc.gz", "CC-NEWS-20171108192520-00144.warc.gz", "CC-NEWS-20171109004709-00145.warc.gz", "CC-NEWS-20171109080647-00146.warc.gz", "CC-NEWS-20171109130641-00147.warc.gz", "CC-NEWS-20171109172845-00148.warc.gz", "CC-NEWS-20171109223430-00149.warc.gz", "CC-NEWS-20171110052912-00150.warc.gz", "CC-NEWS-20171110110031-00151.warc.gz", "CC-NEWS-20171110154731-00152.warc.gz", "CC-NEWS-20171110201430-00153.warc.gz", "CC-NEWS-20171111031428-00154.warc.gz", "CC-NEWS-20171111110552-00155.warc.gz", "CC-NEWS-20171111140231-00000.warc.gz", "CC-NEWS-20171111140232-00001.warc.gz", "CC-NEWS-20171111221935-00002.warc.gz", "CC-NEWS-20171112094244-00003.warc.gz", "CC-NEWS-20171112182547-00004.warc.gz", "CC-NEWS-20171113032154-00005.warc.gz", "CC-NEWS-20171113105358-00006.warc.gz", "CC-NEWS-20171113155741-00007.warc.gz", "CC-NEWS-20171113202203-00008.warc.gz", "CC-NEWS-20171114024802-00009.warc.gz", "CC-NEWS-20171114093843-00010.warc.gz", "CC-NEWS-20171114135509-00011.warc.gz", "CC-NEWS-20171114180017-00012.warc.gz", "CC-NEWS-20171114223514-00013.warc.gz", "CC-NEWS-20171115052020-00014.warc.gz", "CC-NEWS-20171115103404-00015.warc.gz", "CC-NEWS-20171115145230-00016.warc.gz", "CC-NEWS-20171115184215-00017.warc.gz", "CC-NEWS-20171115235317-00018.warc.gz", "CC-NEWS-20171116071718-00019.warc.gz", "CC-NEWS-20171116122141-00020.warc.gz", "CC-NEWS-20171116162327-00021.warc.gz", "CC-NEWS-20171116205729-00022.warc.gz", "CC-NEWS-20171117034628-00023.warc.gz", "CC-NEWS-20171117100228-00024.warc.gz", "CC-NEWS-20171117144340-00025.warc.gz", "CC-NEWS-20171117190953-00026.warc.gz", "CC-NEWS-20171118010739-00027.warc.gz", "CC-NEWS-20171118103941-00028.warc.gz", "CC-NEWS-20171118181211-00029.warc.gz", "CC-NEWS-20171119033657-00030.warc.gz", "CC-NEWS-20171119141243-00031.warc.gz", "CC-NEWS-20171119222548-00032.warc.gz", "CC-NEWS-20171120074503-00033.warc.gz", "CC-NEWS-20171120130459-00034.warc.gz", "CC-NEWS-20171120174409-00035.warc.gz", "CC-NEWS-20171121004108-00036.warc.gz", "CC-NEWS-20171121085134-00037.warc.gz", "CC-NEWS-20171121144704-00038.warc.gz", "CC-NEWS-20171121194730-00039.warc.gz", "CC-NEWS-20171122031417-00040.warc.gz", "CC-NEWS-20171122104125-00041.warc.gz", "CC-NEWS-20171122160432-00042.warc.gz", "CC-NEWS-20171122213025-00043.warc.gz", "CC-NEWS-20171123060810-00044.warc.gz", "CC-NEWS-20171123124833-00045.warc.gz", "CC-NEWS-20171123181044-00046.warc.gz", "CC-NEWS-20171124024144-00047.warc.gz", "CC-NEWS-20171124110501-00048.warc.gz", "CC-NEWS-20171124163809-00049.warc.gz", "CC-NEWS-20171124231952-00050.warc.gz", "CC-NEWS-20171125103320-00051.warc.gz", "CC-NEWS-20171125190456-00052.warc.gz", "CC-NEWS-20171126073947-00053.warc.gz", "CC-NEWS-20171126172252-00054.warc.gz", "CC-NEWS-20171127041825-00055.warc.gz", "CC-NEWS-20171127122523-00056.warc.gz", "CC-NEWS-20171127175644-00057.warc.gz", "CC-NEWS-20171128005042-00058.warc.gz", "CC-NEWS-20171128091732-00059.warc.gz", "CC-NEWS-20171128150355-00060.warc.gz", "CC-NEWS-20171128201413-00061.warc.gz", "CC-NEWS-20171129025828-00062.warc.gz", "CC-NEWS-20171129104545-00063.warc.gz", "CC-NEWS-20171129155018-00064.warc.gz", "CC-NEWS-20171129210320-00065.warc.gz", "CC-NEWS-20171130043026-00066.warc.gz", "CC-NEWS-20171130114616-00067.warc.gz", "CC-NEWS-20171130164107-00068.warc.gz", "CC-NEWS-20171130215944-00069.warc.gz", "CC-NEWS-20171201051809-00070.warc.gz", "CC-NEWS-20171201120628-00071.warc.gz", "CC-NEWS-20171201170305-00072.warc.gz", "CC-NEWS-20171201224505-00073.warc.gz", "CC-NEWS-20171202074648-00074.warc.gz", "CC-NEWS-20171202170647-00075.warc.gz", "CC-NEWS-20171203040156-00076.warc.gz", "CC-NEWS-20171203140121-00077.warc.gz", "CC-NEWS-20171203231815-00078.warc.gz", "CC-NEWS-20171204093116-00079.warc.gz", "CC-NEWS-20171204153449-00080.warc.gz", "CC-NEWS-20171204210306-00081.warc.gz", "CC-NEWS-20171205045805-00082.warc.gz", "CC-NEWS-20171205115156-00083.warc.gz", "CC-NEWS-20171205162708-00084.warc.gz", "CC-NEWS-20171205215525-00085.warc.gz", "CC-NEWS-20171206055235-00086.warc.gz", "CC-NEWS-20171206124935-00087.warc.gz", "CC-NEWS-20171206171938-00088.warc.gz", "CC-NEWS-20171206230206-00089.warc.gz", "CC-NEWS-20171207071741-00090.warc.gz", "CC-NEWS-20171207131608-00091.warc.gz", "CC-NEWS-20171207174310-00092.warc.gz", "CC-NEWS-20171207232418-00093.warc.gz", "CC-NEWS-20171208075108-00094.warc.gz", "CC-NEWS-20171208141142-00095.warc.gz", "CC-NEWS-20171208192732-00096.warc.gz", "CC-NEWS-20171209031759-00097.warc.gz", "CC-NEWS-20171209134214-00098.warc.gz", "CC-NEWS-20171209223632-00099.warc.gz", "CC-NEWS-20171210113342-00100.warc.gz", "CC-NEWS-20171210203659-00101.warc.gz", "CC-NEWS-20171211075724-00102.warc.gz", "CC-NEWS-20171211140445-00103.warc.gz", "CC-NEWS-20171211190734-00104.warc.gz", "CC-NEWS-20171212012644-00105.warc.gz", "CC-NEWS-20171212093917-00106.warc.gz", "CC-NEWS-20171212145044-00107.warc.gz", "CC-NEWS-20171212194856-00108.warc.gz", "CC-NEWS-20171213020948-00109.warc.gz", "CC-NEWS-20171213094348-00110.warc.gz", "CC-NEWS-20171213142016-00111.warc.gz", "CC-NEWS-20171213184608-00112.warc.gz", "CC-NEWS-20171213235023-00113.warc.gz", "CC-NEWS-20171214065704-00114.warc.gz", "CC-NEWS-20171214121924-00115.warc.gz", "CC-NEWS-20171214164531-00116.warc.gz", "CC-NEWS-20171214212521-00117.warc.gz", "CC-NEWS-20171215042535-00118.warc.gz", "CC-NEWS-20171215104334-00119.warc.gz", "CC-NEWS-20171215152315-00120.warc.gz", "CC-NEWS-20171215195833-00121.warc.gz", "CC-NEWS-20171216020053-00122.warc.gz", "CC-NEWS-20171216101619-00123.warc.gz", "CC-NEWS-20171216171946-00124.warc.gz"]

i = 0
warc_counter = 0
politico = []
slate = []
rawstory = []


for path in warc_paths:
	print(str(warc_counter) + " WARCs done.\n")
	
	with open(path, 'rb') as stream:

		for record in ArchiveIterator(stream):

			r = record.rec_headers.get_header('WARC-Target-URI')

			if (i % 250 == 0):
				print(str(i) + " records done.")
			if record.rec_type == 'response':
				if (".politico.com" in r):
					print(record.rec_headers.get_header('WARC-Target-URI'))
					politico.append(record.rec_headers.get_header('WARC-Target-URI'))
				elif("slate.com" in r):
					print(record.rec_headers.get_header('WARC-Target-URI'))
					slate.append(record.rec_headers.get_header('WARC-Target-URI'))					
				elif("rawstory.com" in r):
					print(record.rec_headers.get_header('WARC-Target-URI'))
					rawstory.append(record.rec_headers.get_header('WARC-Target-URI'))					
			i += 1



	warc_counter += 1


print("There were " + str(len(politico)) + " stories from politico.")
print("There were " + str(len(slate)) + " stories from slate.")
print("There were " + str(len(rawstory)) + " stories from rawstory.")


pickle.dump(politico, open("politicourls.pickle", 'wb'))
pickle.dump(slate, open("slateurls.pickle", 'wb'))
pickle.dump(rawstory, open("rawstoryurls.pickle", 'wb'))
